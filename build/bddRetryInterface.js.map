{"version":3,"sources":["../source/bddRetryInterface.js"],"names":[],"mappings":"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","file":"bddRetryInterface.js","sourcesContent":["\"use strict\";\n\nimport {Suite} from \"mocha\";\nimport RetryTest from \"./retryTest\";\nimport escapeStringRegexp from \"escape-string-regexp\";\n\nexport default function createInterface() {\n\n\treturn (suite) => {\n\t\tconst suites = [suite];\n\t\tsuite.on(\"pre-require\", (context, file, mocha) => {\n\t\t\tcontext.before = (...args) => suites[0].beforeAllWithRetry(...args);\n\t\t\tcontext.after = (...args) => suites[0].afterAllWithRetry(...args);\n\t\t\tcontext.beforeEach = (...args) => suites[0].beforeEachWithRetry(...args);\n\t\t\tcontext.afterEach = (...args) => suites[0].afterEachWithRetry(...args);\n\t\t\tcontext.describe = context.context = (times, title, fn) => {\n\t\t\t\tif (!fn) {\n\t\t\t\t\t[times, title, fn] = [void 0, times, title];\n\t\t\t\t}\n\t\t\t\ttimes = times || suites[0].times || ~~process.env.MOCHA_RETRY;\n\t\t\t\tconst asuite = Suite.create(suites[0], title);\n\t\t\t\tasuite.times = times;\n\t\t\t\tasuite.file = file;\n\t\t\t\tsuites.unshift(asuite);\n\t\t\t\tfn.call(asuite);\n\t\t\t\tsuites.shift();\n\t\t\t\treturn asuite;\n\t\t\t};\n\t\t\tcontext.xdescribe = context.xcontext = context.describe.skip = (times, title, fn) => {\n\t\t\t\tif (!fn) {\n\t\t\t\t\t[times, title, fn] = [void 0, times, title];\n\t\t\t\t}\n\t\t\t\tconst asuite = Suite.create(suites[0], title);\n\t\t\t\tasuite.pending = true;\n\t\t\t\tsuites.unshift(asuite);\n\t\t\t\tfn.call(asuite);\n\t\t\t\treturn suites.shift();\n\t\t\t};\n\t\t\tcontext.describe.only = (times, title, fn) => {\n\t\t\t\tconst asuite = context.describe(times, title, fn);\n\t\t\t\tmocha.grep(asuite.fullTitle());\n\t\t\t\treturn asuite;\n\t\t\t};\n\t\t\tcontext.it = context.itretry = (times, title, fn) => {\n\t\t\t\tconst asuite = suites[0];\n\t\t\t\tif (!fn && typeof times !== \"number\") {\n\t\t\t\t\t[times, title, fn] = [asuite.times || 1, times, title];\n\t\t\t\t}\n\t\t\t\tif (asuite.pending) {\n\t\t\t\t\tfn = null;\n\t\t\t\t}\n\t\t\t\tconst test = new RetryTest(times, title, fn);\n\t\t\t\ttest.file = file;\n\t\t\t\tasuite.addTest(test);\n\t\t\t\treturn test;\n\t\t\t};\n\t\t\tcontext.it.only = (times, title, fn) => {\n\t\t\t\tconst asuite = suites[0];\n\t\t\t\tif (!fn && typeof times !== \"number\") {\n\t\t\t\t\t[times, title, fn] = [process.env.MOCHA_IT_ONLY_ONCE === \"true\" ? 1 : asuite.times || 1, times, title];\n\t\t\t\t}\n\t\t\t\tconst test = context.it(times, title, fn);\n\t\t\t\tconst reString = \"^\" + escapeStringRegexp(test.fullTitle()) + \"$\";\n\t\t\t\tmocha.grep(new RegExp(reString));\n\t\t\t\treturn test;\n\t\t\t};\n\t\t\tcontext.xit = context.xspecify = context.it.skip = (times, title, fn) => {\n\t\t\t\tif (!title) {\n\t\t\t\t\treturn context.it(times);\n\t\t\t\t}\n\t\t\t\tif (!fn) {\n\t\t\t\t\t[times, title, fn] = [1, times, title];\n\t\t\t\t}\n\t\t\t\treturn context.it(times, title);\n\t\t\t};\n\t\t});\n\t};\n};\n"]}